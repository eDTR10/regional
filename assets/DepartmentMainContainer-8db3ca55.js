import{r as d,j as e,D as b,s as k,t as v,v as T,w as S,x as C,I as x,O as m,V as O,a as u,S as h,W as A,e as E,f as I,g as $,h as D,i as w,k as z,l as N,R as B}from"./index-e7b6b6d5.js";import{P as F}from"./pen-74177672.js";import{S as R}from"./sheet-2edcac6a.js";function q({deptData:o,fetchData:f}){const[r,l]=d.useState({...o,office:Array.isArray(o.office)?o.office:[]}),[i,c]=d.useState(!1);d.useEffect(()=>{l(o)},[o]);async function a(){u.put(`department/${r.deptid}/`,r,{headers:{Authorization:`Token ${localStorage.getItem("accessToken")}`}}).then(t=>{c(!1),f(),h.fire({icon:"success",title:"Updated Successfully...",showConfirmButton:!1,timer:2e3})}).catch(t=>{console.error("Error updating department:",t),h.fire({icon:"error",title:"Oops...",text:"Something went wrong while updating the data!"})})}const g=()=>{l(t=>({...t,office:[...t.office,""]}))},j=t=>{l(n=>({...n,office:n.office.filter((p,y)=>y!==t)}))},s=(t,n)=>{l(p=>({...p,office:p.office.map((y,_)=>_===t?n:y)}))};return e.jsxs(b,{open:i,onOpenChange:c,children:[e.jsx(k,{asChild:!0,children:e.jsx(F,{onClick:()=>c(!0),className:" cursor-pointer w-4 h-4 hover:text-primary/80"})}),e.jsxs(v,{className:"sm:max-w-[90%] text-foreground",children:[e.jsxs(T,{children:[e.jsx(S,{children:"Edit office"}),e.jsx(C,{children:"Make changes to the office here. Click save when you're done."})]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),a()},className:"grid gap-4 py-5",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-foreground",children:"Office ID"}),e.jsx(x,{id:"name",value:r.deptid,onChange:t=>l({...r,deptid:Number(t.target.value)}),className:"bg-muted pointer-events-none text-foreground col-span-3"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-foreground",children:"Office name"}),e.jsx(x,{id:"username",value:r.dept_name,required:!0,onChange:t=>l({...r,dept_name:t.target.value}),className:"text-foreground col-span-3"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-foreground",children:"office Names"}),e.jsx(m,{type:"button",variant:"outline",onClick:g,className:"px-2 py-1 h-8",children:"Add office"})]}),r.office.map((t,n)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(x,{value:t,onChange:p=>s(n,p.target.value),className:"text-foreground",placeholder:"Enter office name"}),e.jsx(m,{type:"button",variant:"destructive",onClick:()=>j(n),className:"px-2 py-1 h-8",children:"Remove"})]},n))]}),e.jsx(m,{type:"submit",children:"Save changes"})]}),e.jsx(O,{})]})]})}function H({fetchData:o}){const[f,r]=d.useState({deptid:null,dept_name:""}),[l,i]=d.useState(!1);async function c(){u.post("department/all/",f,{headers:{Authorization:`Token ${localStorage.getItem("accessToken")}`}}).then(a=>{i(!1),o(),r({deptid:null,dept_name:""}),h.fire({icon:"success",title:"addedd Successfully...",showConfirmButton:!1,timer:2e3})}).catch(a=>{console.error("Error updating department:",a),h.fire({icon:"error",title:"Oops...",text:"Something went wrong while adding the data!"})})}return e.jsxs(b,{open:l,onOpenChange:i,children:[e.jsx(k,{asChild:!0,children:e.jsxs(m,{variant:"default",className:" text-white flex gap-2 mr-2",children:[e.jsx("p",{children:"Add Office"}),e.jsx(A,{onClick:()=>i(!0),className:" cursor-pointer w-4 h-4 text-white"})]})}),e.jsxs(v,{className:"sm:max-w-[90%] text-foreground",children:[e.jsxs(T,{children:[e.jsx(S,{children:"Add office"}),e.jsx(C,{children:"Add office here. Click save when you're done."})]}),e.jsxs("form",{onSubmit:a=>{a.preventDefault(),c()},className:"grid gap-4 py-5",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-foreground",children:"Office name"}),e.jsx(x,{id:"username",value:f.dept_name,required:!0,onChange:a=>r({...f,dept_name:a.target.value}),className:"text-foreground col-span-3"})]}),e.jsx(m,{type:"submit",children:"Save Office"})]}),e.jsx(O,{})]})]})}const L=()=>{const[o,f]=d.useState(""),[r,l]=d.useState([]),[i,c]=d.useState({open:!1,employee:{}}),a=async()=>{u.get("department/all/",{headers:{Authorization:`Token ${localStorage.getItem("accessToken")}`}}).then(s=>{l(s.data)}).catch(s=>{console.error("Error fetching data:",s.response?s.response.data:s.message),h.fire({icon:"error",title:"Oops...",text:"Something went wrong while fetching the data!"})})};d.useEffect(()=>{a()},[]);async function g(s){u.delete(`department/${s}/`,{headers:{Authorization:`Token ${localStorage.getItem("accessToken")}`}}).then(t=>{a(),c({open:!1,employee:{}}),h.fire({icon:"success",title:"Deleted Successfully...",showConfirmButton:!1,timer:2e3})}).catch(t=>{console.error("Error updating department:",t),h.fire({icon:"error",title:"Oops...",text:"Something went wrong while Deleting the data!"})})}const j=r.filter(s=>{var n;return(n=s.dept_name)==null?void 0:n.toLowerCase().includes(o.toLowerCase())});return e.jsxs("div",{id:"printss",className:"  relative flex flex-col gap-4  mt-20 w-xl p-2 m-4 border border-border bg-primary-foreground rounded-md min-h-[130px]",children:[e.jsxs("div",{className:"flex p-4 justify-between items-center bg-primary mb-2",children:[e.jsx("p",{className:"text-white ",children:"LIST OF OFFICE"}),e.jsx(R,{className:"text-6xl text-white"})]}),e.jsxs("div",{className:"flex items-center content-center justify-between py-2 ",children:[e.jsxs("div",{className:" h-8 w-1/2 flex gap-2",children:[e.jsx(E,{className:"text-primary mr-2 "}),e.jsx("input",{type:"text",placeholder:" Search...",value:o,onChange:s=>f(s.target.value),className:"outline-none  focus:outline-primary  border pl-2 h-full border-border rounded w-full text-foreground bg-primary-foreground"})]}),e.jsx(H,{fetchData:a})]}),e.jsx("div",{className:"overflow-auto bg-primary-foreground max-h-full",children:e.jsxs(I,{children:[e.jsx($,{children:e.jsxs(D,{children:[e.jsx(w,{className:"w-[40px] border border-border text-white sticky top-0 bg-primary",children:"#"}),e.jsx(w,{className:"text-white border border-border text-md sticky top-0 bg-primary",children:"Office"}),e.jsx(w,{className:"text-white border border-border text-md sticky top-0 bg-primary",children:"actions"})]})}),e.jsx(z,{children:j.map((s,t)=>e.jsxs(D,{className:" border border-border",children:[e.jsx(N,{className:"font-small",children:s.deptid}),e.jsx(N,{children:s.dept_name}),e.jsx(N,{children:e.jsxs("div",{className:" flex items-center justify-center gap-5",children:[e.jsx(q,{deptData:s,fetchData:a}),e.jsx(B,{onClick:()=>{c({open:!0,employee:s})},className:" text-red-600 w-4  h-4 cursor-pointer "})]})})]},t))})]})}),e.jsx(b,{open:i.open,onOpenChange:s=>{c({...i,open:s})},children:e.jsxs(v,{className:" z-50 absolute rounded-md",children:[e.jsx(S,{className:"text-foreground",children:"Confirm Delete Office"}),e.jsxs(C,{children:['Are you sure you want to delete "',i.employee.dept_name,'" Office?']}),e.jsxs(O,{children:[e.jsx(m,{variant:"outline",className:"text-foreground mt-2",onClick:()=>{c({open:!1,employee:{}})},children:"Cancel"}),e.jsx(m,{className:"text-white",onClick:()=>{g(i.employee.deptid)},children:"Confirm"})]})]})})]})},V=()=>e.jsx("div",{className:"flex flex-col w-full mt-16 sm:mt-4 overflow-hidden min-h-screen",children:e.jsx(L,{})});export{V as default};
