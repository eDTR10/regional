import{W as Z,c as H,m as q,j as e,X,Y as G,Z as r,_ as i,$ as O,a0 as Q,r as u,a1 as ee,a2 as te,O as T,a3 as ne,a4 as re,a5 as ie,a6 as K,a7 as se,a8 as le,a9 as oe,aa as ae,ab as ce,ac as de,ad as he,ae as ge,S as Y,af as V,f as fe,g as xe,h as F,i as $,k as W,l as v,ag as ue,d as pe,a as P}from"./index-326c0273.js";Z.register({family:"Roboto",fonts:[{src:"https://edtr10.github.io/regional/calibri-font-family/calibri-regular.ttf"},{src:"https://edtr10.github.io/regional/calibri-font-family/calibri-italic.ttf",fontStyle:"italic"},{src:"https://edtr10.github.io/regional/calibri-font-family/calibri-bold.ttf",fontStyle:"bold"}]});const J=({name:a,date:b,data:m,selectedYear:y,selectedMonth:S,previewUrl:A})=>{var C,h;const L=t=>new Date(t).getUTCDate();let l={};(C=m.results)==null||C.forEach(t=>{const s=L(t.CHECKTIME);l[s]||(l[s]={I:[],O:[],i:[],o:[]});const x=H(t.CHECKTIME).localeTime12HourFormat;t.CHECKTYPE==="I"?l[s].I.push(x.replace(/ AM| PM/,"")):t.CHECKTYPE==="o"?l[s].O.push(x.replace(/ AM| PM/,"")):t.CHECKTYPE==="0"?l[s].i.push(x.replace(/ AM| PM/,"")||"12:00"):t.CHECKTYPE==="i"&&l[s].o.push(x.replace(/ AM| PM/,""))});const f={};(h=m.activities)==null||h.forEach(t=>{const s=new Date(t.fromDate),x=new Date(t.toDate);for(let d=new Date(s);d<=x;d.setDate(d.getDate()+1)){const c=d.getDate();f[c]||(f[c]=[]),f[c].push({activity_id:t.activity_id,description:`${q(t.status)} - ${t.description}`,status:t.status,period:t.period})}});const D=t=>{switch(t.length){case 4:return t[0];case 3:return t[0];case 2:return t[0];case 1:return t[0];default:return""}},w=t=>{switch(t.length){case 4:return t[0];case 3:return t[0];case 2:return t[0];case 1:return t[0];default:return""}},I=(t,s)=>{switch(t.length){case 3:return s.length!=0&&t.length!=2?"12:00":t[0];case 2:return s.length!=0&&t.length!=2?"12:00":t[0];case 1:return s.length!=0&&t.length!=1?"12:00":t[0];default:return s.length!=0?"12:00":""}},k=(t,s)=>{switch(t.length){case 3:return s.length!=0&&s.length!=3?"01:00":t[0];case 2:return s.length!=0&&s.length!=2?"01:00":t[0];case 1:return s.length!=0&&s.length!=1?"01:00":t[0];default:return s.length!=0?"01:00":""}};return e.jsx(X,{title:`${a.toUpperCase()}_DTR_${b}.pdf`,children:e.jsx(G,{size:"A4",style:{fontFamily:"Roboto",flexDirection:"row",backgroundColor:"#ffffff",fontSize:8,padding:30},children:[1,2].map((t,s)=>e.jsxs(r,{style:{width:"50%",paddingHorizontal:8},children:[e.jsx(i,{style:{fontSize:6,marginBottom:5,fontStyle:"italic"},children:"  Civil Service Form No. 48"}),e.jsx(O,{src:Q,style:{height:60,objectFit:"contain",alignSelf:"center",marginBottom:10}}),e.jsx(i,{style:{fontSize:10,fontStyle:"bold",textAlign:"center",marginBottom:3},children:"DAILY TIME RECORD"}),e.jsx(i,{style:{fontSize:10,textAlign:"center",marginBottom:10}}),e.jsx(i,{style:{fontSize:9,textAlign:"center",textTransform:"uppercase",borderBottom:.5,marginBottom:1,fontStyle:"bold"},children:a.toUpperCase()?a.toUpperCase():"JOHN C. DOE"}),e.jsx(i,{style:{fontSize:8,textAlign:"center"},children:"( Name )"}),e.jsxs(r,{style:{flexDirection:"row",marginTop:10,marginBottom:5},children:[e.jsxs(r,{style:{width:"50%",textAlign:"left"},children:[e.jsx(i,{children:"For the month of"}),e.jsx(i,{children:"Official hours for arrival"}),e.jsx(i,{children:"and departure"})]}),e.jsxs(r,{style:{width:"50%"},children:[e.jsx(i,{style:{borderBottom:.5,marginBottom:1,fontStyle:"bold",textAlign:"center"},children:b}),e.jsxs(r,{style:{flexDirection:"row"},children:[e.jsx(i,{children:"Regular days"}),e.jsx(r,{style:{borderBottom:.5,marginBottom:1,marginLeft:22,width:"100%"}})]}),e.jsxs(r,{style:{flexDirection:"row"},children:[e.jsx(i,{children:"Saturdays"}),e.jsx(r,{style:{borderBottom:.5,marginBottom:1,marginLeft:20,width:"100%"}})]})]})]}),e.jsxs(r,{style:{border:.5,marginVertical:10},children:[e.jsxs(r,{style:{flexDirection:"row",borderBottom:.5,alignItems:"center",height:12,fontSize:7},children:[e.jsx(r,{style:{width:"8%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{children:"Day"})}),e.jsx(r,{style:{width:"34.5%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{children:"AM"})}),e.jsx(r,{style:{width:"34.5%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{children:"PM"})}),e.jsx(r,{style:{width:"23%",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{children:"Undertime"})})]},s),e.jsxs(r,{style:{flexDirection:"row",borderBottom:.5,alignItems:"center",height:12,fontSize:7},children:[e.jsx(r,{style:{width:"8%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{})}),e.jsx(r,{style:{width:"17.25%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{children:"Arrival"})}),e.jsx(r,{style:{width:"17.25%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{children:"Departure"})}),e.jsx(r,{style:{width:"17.25%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{children:"Arrival"})}),e.jsx(r,{style:{width:"17.25%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{children:"Departure"})}),e.jsx(r,{style:{width:"10%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{children:"Hours"})}),e.jsx(r,{style:{width:"13%",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{children:"Minutes"})})]},s),Array.from({length:31},(x,d)=>{var B,z,_,U;const c=d+1,p=new Date(y,S-1,c).getDay(),n=p===0?"Sunday":p===6?"Saturday":"",o=((B=l[c])==null?void 0:B.I)||"",g=((z=l[c])==null?void 0:z.O)||"",R=((_=l[c])==null?void 0:_.i)||"",N=((U=l[c])==null?void 0:U.o)||"",j=f[c]||[];return n||j.length>0?e.jsxs(r,{style:{flexDirection:"row",borderBottom:.5,alignItems:"center",height:12,fontSize:7,textAlign:"center"},children:[e.jsx(r,{style:{width:"8%",borderRight:.5,height:"100%",alignItems:"center",justifyContent:"center",textAlign:"center"},children:e.jsxs(i,{style:{textAlign:"center",marginTop:2},children:[c," "]})}),(j==null?void 0:j.length)>0?j==null?void 0:j.map((E,M)=>{if(E.period===1)return e.jsx(r,{style:{width:"69%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:`${E.description}`})},M);if(E.period===2)return e.jsxs(e.Fragment,{children:[e.jsx(r,{style:{width:"34.5%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:`${E.description}`})},M),e.jsx(r,{style:{width:"17.25%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:k(N,g)})}),e.jsx(r,{style:{width:"17.25%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:w(g)})})]});if(E.period===3)return e.jsxs(e.Fragment,{children:[e.jsx(r,{style:{width:"17.25%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:D(o)})}),e.jsx(r,{style:{width:"17.25%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:I(R,o)})}),e.jsx(r,{style:{width:"34.5%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:`${E.description}`})},M)]})}):n?e.jsx(r,{style:{width:"69%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center",backgroundColor:"#c7e8f0"},children:e.jsxs(i,{style:{textAlign:"center",marginTop:2},children:[n||j||`${n}`," ",o?`-${D(o)}`:"","   ",g?`| ${w(g)}`:""," "]})}):"",e.jsx(r,{style:{width:"10%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:"0"})}),e.jsx(r,{style:{width:"10%",paddingLeft:2,height:"100%",alignItems:"center",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:"0"})})]},d):e.jsxs(r,{style:{flexDirection:"row",borderBottom:.5,alignItems:"center",height:12,fontSize:7,textAlign:"center"},children:[e.jsx(r,{style:{width:"8%",borderRight:.5,height:"100%",alignItems:"center",justifyContent:"center",textAlign:"center"},children:e.jsxs(i,{style:{textAlign:"center",marginTop:2},children:[c," ",n&&`(${n})`]})}),e.jsx(r,{style:{width:"17.25%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:D(o)})}),e.jsx(r,{style:{width:"17.25%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:I(R,o)})}),e.jsx(r,{style:{width:"17.25%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:k(N,g)})}),e.jsx(r,{style:{width:"17.25%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:w(g)})}),e.jsx(r,{style:{width:"10%",borderRight:.5,alignItems:"center",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:"0"})}),e.jsx(r,{style:{width:"10%",paddingLeft:2,height:"100%",alignItems:"center",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:"0"})})]},d)}),e.jsxs(r,{style:{flexDirection:"row",borderBottom:"none",alignItems:"center",height:12},children:[e.jsx(r,{style:{width:"77%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"},children:e.jsx(i,{style:{textAlign:"center",marginTop:2},children:"Total"})}),e.jsx(r,{style:{width:"10%",borderRight:.5,paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"}}),e.jsx(r,{style:{width:"13%",paddingLeft:2,height:"100%",justifyContent:"center",textAlign:"center"}})]})]}),e.jsx(i,{style:{fontSize:7,marginTop:5,textAlign:"justify",fontStyle:"italic",fontWeight:100},children:"I certify on my honor that the above is a true and correct report of the hours of work performed, record of which was made daily at the time of arrival and departure from office."}),e.jsxs(r,{style:{fontSize:8,textAlign:"center",marginTop:20},children:[A&&e.jsx(O,{src:A,style:{width:"80px",position:"absolute",alignSelf:"center",objectFit:"contain",transform:"translateY(-30px)",zIndex:100}}),e.jsx(i,{style:{borderBottom:.5,paddingTop:2,fontStyle:"bold"},children:a.toUpperCase()})]}),e.jsx(i,{style:{fontSize:7,marginTop:10,textAlign:"justify"},children:"VERIFIED as to the prescribed office hours."}),e.jsxs(r,{style:{fontSize:8,textAlign:"center",marginTop:30},children:[e.jsx(i,{style:{borderBottom:.5,paddingTop:2,fontStyle:"bold"},children:"NIDELIZA FE O. NACILLA"}),e.jsx(i,{style:{fontSize:7,fontStyle:"italic",marginTop:2},children:"Name and Signature of Immediate Supervisor"})]})]},s))})})};function je({name:a,data:b,date:m,show:y,selectedYear:S,selectedMonth:A}){const[L,l]=u.useState(null),[f,D]=u.useState(null),w=u.useRef(null),I=h=>{var s;const t=(s=h.target.files)==null?void 0:s[0];t&&(l(t),D(URL.createObjectURL(t)))},k=()=>{var h;(h=w.current)==null||h.click()},C=async()=>{const h=e.jsx(J,{name:a,previewUrl:f,date:m,data:b,selectedYear:S,selectedMonth:A}),t=he();t.updateContainer(h);const s=await t.toBlob(),d=await(await ge.load(await s.arrayBuffer())).save(),c=new Blob([d],{type:"application/pdf"}),p=document.createElement("a");p.href=URL.createObjectURL(c),p.download=`${a.toUpperCase()}_DTR_${m}.pdf`,p.click(),URL.revokeObjectURL(p.href)};return e.jsxs(ee,{children:[e.jsx(te,{className:y?"  z-20 w-full flex gap-2 ":" flex gap-2 text-foreground z-20 w-full pointer-events-none  ",children:e.jsxs(T,{type:"button",variant:y?"default":"outline",className:y?"  z-20 w-full flex gap-2 ":" flex gap-2 text-foreground z-20 w-full pointer-events-none ",children:["Show PDF ",e.jsx(ne,{className:y?" w-4 h-4 animate-bounce":" w-4 h-4 "})," "]})}),e.jsx(re,{title:"DTR",description:"Optional Description",children:e.jsx("div",{className:"h-[70vh] sm:h-[30vh]   w-full overflow-y-scroll sm:overflow-hidden  bg-white ",children:ie?e.jsxs(T,{onClick:C,value:"",children:["Save DTR  ",e.jsx(K,{className:" h-4 w-4 ml-2 animate-bounce"})," "]}):e.jsxs(u.Suspense,{fallback:e.jsx("div",{}),children:[e.jsxs("div",{className:" flex w-full items-center justify-center h-20 gap-10",children:[e.jsxs(T,{onClick:C,value:"",children:["Save DTR  ",e.jsx(K,{className:" h-4 w-4 ml-2 animate-bounce"})," "]}),e.jsx("input",{type:"file",accept:"image/*",onChange:I,ref:w,className:"hidden"}),e.jsx(se,{children:e.jsxs(le,{children:[e.jsx(oe,{asChild:!0,children:e.jsxs(T,{onClick:k,variant:"outline",children:["Add Signature ",e.jsx(ae,{className:" h-4 w-4 ml-2"})," "]})}),e.jsx(ce,{children:e.jsx("p",{children:"image size 789x579"})})]})})]}),e.jsx(de,{className:"w-full h-full",children:e.jsx(J,{name:a.toUpperCase(),previewUrl:f,date:m,data:b,selectedYear:S,selectedMonth:A})})]})})})]})}function me(){var p;const[a,b]=u.useState({userId:null,fromDate:"",toDate:""}),m=n=>{const o=new Date(n),g=o.getMonth()+1,R=o.getFullYear();return{month:g,year:R}},[y,S]=u.useState(!1),[A,L]=u.useState(!1),[l,f]=u.useState([]),[D,w]=u.useState([]);function I(){L(!0),P.get("checkinoutregion/by_user/",{headers:{Authorization:`Token ${localStorage.getItem("accessToken")}`}}).then(n=>{L(!1),f(n.data)})}function k(){P.post("checkinoutregion/user_filter_by_user_date/",{fromDate:a.fromDate,toDate:a.toDate},{headers:{Authorization:`Token ${localStorage.getItem("accessToken")}`}}).then(n=>{f(n.data),w(n.data),S(!0),Y.fire({icon:"success",title:"Table updated",showConfirmButton:!1,timer:2e3})})}function C(n){P.get(`${n}`,{headers:{Authorization:`Token ${localStorage.getItem("accessToken")}`}}).then(o=>{f(o.data)})}u.useEffect(()=>{let n=!0;return n&&(localStorage.setItem("selectedName",""),I()),()=>{n=!1}},[]);function h(n){const o="https://edtr.pythonanywhere.com/api/v1/";return n.startsWith(o)?n.replace(o,""):n}const[t,s]=u.useState({key:"CHECKTIME",direction:"descingding"}),x=(p=l==null?void 0:l.results)==null?void 0:p.sort((n,o)=>n[t.key]<o[t.key]?t.direction==="ascending"?-1:1:n[t.key]>o[t.key]?t.direction==="ascending"?1:-1:0),d=n=>{let o="ascending";t.key===n&&t.direction==="ascending"&&(o="descending"),s({key:n,direction:o})};function c(n,o){const g=new Date(n),R=new Date(o),N=g.getDate(),j=R.getDate(),B=g.toLocaleString("en-US",{month:"long"}),z=g.getFullYear();return`${B} ${N}-${j}, ${z}`}return e.jsxs("div",{id:"printss",className:"  relative flex flex-col gap-4 pt-20 w-xl p-2 m-4 border border-border bg-primary-foreground rounded-md min-h-[130px]",children:[e.jsxs("form",{onSubmit:n=>{n.preventDefault(),localStorage.getItem("accessToken")?k():Y.fire({icon:"error",title:"Oops...",text:"Employee's name is blank...",showConfirmButton:!1})},className:" flex sm:flex-col items-end gap-2",children:[e.jsxs("div",{className:" flex  sm:flex gap-2 w-full",children:[e.jsx(V,{label:"From:",value:a.fromDate,onChange:n=>{b({...a,fromDate:n.target.value})},className:" text-foreground flex justify-between",type:"date"}),e.jsx(V,{className:" text-foreground ",value:a.toDate,onChange:n=>{b({...a,toDate:n.target.value})},label:"To:",type:"date"})]}),e.jsx(T,{className:" sm:w-full",children:"Filter"}),e.jsx("div",{className:y?" sm:w-full w-[400px] z-20 ":" sm:w-full w-[400px] z-20  cursor-not-allowed ",children:e.jsx(je,{name:JSON.parse(localStorage.getItem("user")||"").full_name,data:D,selectedYear:m(a.fromDate).year,selectedMonth:m(a.fromDate).month,show:y,date:c(a.fromDate,a.toDate)})})]}),e.jsx("div",{className:"overflow-auto bg-primary-foreground max-h-full",children:e.jsxs(fe,{tableName:"attendances",className:" ",children:[e.jsx(xe,{children:e.jsxs(F,{children:[e.jsxs($,{className:"w-[170px] border border-border text-white sticky top-0 bg-primary cursor-pointer",onClick:()=>d("full_name"),children:["Employee name ",t.key==="full_name"?t.direction==="ascending"?"↑":"↓":""]}),e.jsxs($,{className:"text-white border border-border text-md sticky top-0 bg-primary cursor-pointer",onClick:()=>d("CHECKTIME"),children:["Checked date ",t.key==="CHECKTIME"?t.direction==="ascending"?"↑":"↓":""]}),e.jsxs($,{className:"text-white border border-border text-md sticky top-0 bg-primary cursor-pointer",onClick:()=>d("CHECKTIME"),children:["Checked time ",t.key==="CHECKTIME"?t.direction==="ascending"?"↑":"↓":""]}),e.jsxs($,{className:"text-white border border-border text-md sticky top-0 bg-primary cursor-pointer",onClick:()=>d("CHECKTYPE"),children:["Checked type ",t.key==="CHECKTYPE"?t.direction==="ascending"?"↑":"↓":""]})]})}),A?e.jsx(W,{children:[1,2,3,4,5,6,7,8].map(n=>e.jsx(F,{className:"border border-border",children:e.jsx(v,{colSpan:4,children:e.jsx(ue,{className:" w-full h-[30px] py-3"})})},n))}):e.jsx(W,{children:x?x.map((n,o)=>e.jsxs(F,{className:"border border-border",children:[e.jsx(v,{className:"font-small",children:n==null?void 0:n.full_name}),e.jsx(v,{children:H(n.CHECKTIME).customLongDateFormat}),e.jsx(v,{children:H(n==null?void 0:n.CHECKTIME).localeTime12HourFormat}),e.jsx(v,{children:pe(n==null?void 0:n.CHECKTYPE)})]},o)):""})]})}),e.jsxs("div",{className:" flex gap-5",children:[e.jsx(T,{className:l.previous?"":" bg-card text-foreground",variant:l.previous?"default":"ghost",onClick:()=>{l.previous&&C(h(l.previous))},children:"Prev"}),e.jsx(T,{onClick:()=>{console.log(h(l.next)[0]=="c"),h(l.next)[0]=="c"&&l.next&&C(h(l.next))},children:"Next"})]})]})}const be=()=>e.jsx("div",{className:"  flex flex-col w-full overflow-hidden min-h-screen ",children:e.jsx(me,{})});export{be as default};
